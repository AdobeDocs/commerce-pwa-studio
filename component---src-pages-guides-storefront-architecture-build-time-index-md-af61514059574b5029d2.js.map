{"version":3,"file":"component---src-pages-guides-storefront-architecture-build-time-index-md-af61514059574b5029d2.js","mappings":"oNAOsBA,E,wEADTC,EAAe,CAAC,EAKvBC,GAJgBF,EAIY,cAJJ,SAA6BG,GAEzD,OADAC,QAAQC,KAAK,aAAeL,EAAO,4EAC5B,eAASG,EAClB,GAEMG,EAAc,CAClBL,aAAAA,GAEIM,EAAYC,EAAAA,EACH,SAASC,EAAW,GAGhC,IAFDC,EAAU,EAAVA,WACGP,GAAK,YAER,OAAO,SAACI,GAAS,UAAKD,EAAiBH,EAAK,CAAEO,WAAYA,EAAYC,QAAQ,eAG5E,eACE,GAAM,2BAAyB,4BAEjC,4KACA,eACE,GAAM,kCAAgC,mCAExC,6DAA8C,cAAGC,WAAW,IACxD,KAAQ,+DAA6D,iCAC/B,0NAG1C,4TAEA,eACE,GAAM,2BAAyB,4BAEjC,kTAGA,4DAA6C,uBAAYA,WAAW,KAAG,QAAsB,yIAE7F,mEAAoD,cAAGA,WAAW,IAC9D,KAAQ,2CACP,uBAAYA,WAAW,KAAG,cAA4B,eAAmB,iPAG9E,+FAAgF,cAAGA,WAAW,IAC1F,KAAQ,gCAA8B,kCACC,MAC3C,eACE,GAAM,kBAAgB,mBAExB,gKACyB,cAAGA,WAAW,IACnC,KAAQ,2DAAyD,iBAC3C,wFAC2B,cAAGA,WAAW,IAC/D,KAAQ,gCAA8B,UACvB,MACnB,qEAAsD,cAAGA,WAAW,IAChE,KAAQ,sBAAoB,SACd,SAAS,cAAGA,WAAW,IACrC,KAAQ,2BAAyB,WACjB,8KAEpB,2HAA4G,uBAAYA,WAAW,KAAG,oBAAkC,qHAExK,eACE,GAAM,qBAAmB,sBAE3B,qHACA,eACE,GAAM,oBAAkB,qBAE1B,4IAC+D,uBAAYA,WAAW,KAAG,QAAsB,YAC/G,8CAA+B,cAAGA,WAAW,IACzC,KAAQ,uCAAqC,eACzB,kDACpB,uBAAYA,WAAW,KAAG,YAA0B,+BAA+B,uBAAYA,WAAW,KAAG,WAAyB,uCAAuC,cAAGA,WAAW,IAC3L,KAAQ,0FAAwF,gBAC3E,WACzB,8BAAe,uBAAYA,WAAW,KAAG,SAAuB,yCAChE,qBAAK,iBAAMA,WAAW,MAClB,UAAa,eAAa,sBAG9B,eACE,GAAM,gBAAc,iBAEtB,+CAAgC,uBAAYA,WAAW,KAAG,SAAuB,6DAA6D,uBAAYA,WAAW,KAAG,QAAsB,2CAC9L,eACE,GAAM,0BAAwB,2BAEhC,8CAA+B,uBAAYA,WAAW,KAAG,sBAAoC,sCAAsC,uBAAYA,WAAW,KAAG,QAAsB,oIAEnL,0BAAW,cAAGA,WAAW,IACrB,KAAQ,2CAAyC,4BAChB,2BACrC,SAACV,EAAW,CAACW,QAAQ,OAAOC,MAAM,OAAOH,QAAQ,iBACjD,qCAAsB,uBAAYC,WAAW,KAAG,QAAsB,+CAA+C,cAAGA,WAAW,IAC/H,KAAQ,gDACP,uBAAYA,WAAW,KAAG,6BAA2C,YAAgB,MAC1F,eACE,GAAM,oBAAkB,qBAE1B,iFAAkE,uBAAYA,WAAW,KAAG,oBAAkC,mCAC3G,cAAGA,WAAW,IAC7B,KAAQ,yGACP,uBAAYA,WAAW,KAAG,6CAA8D,+IAC7F,SAACV,EAAW,CAACW,QAAQ,OAAOC,MAAM,OAAOH,QAAQ,iBACjD,qGAAsF,uBAAYC,WAAW,KAAG,uBAAqC,2BACrJ,eACE,GAAM,qBAAmB,sBAE3B,gFAAiE,uBAAYA,WAAW,KAAG,WAAyB,0CAClH,uBAAYA,WAAW,KAAG,qBAAmC,4JAC/D,4EAA6D,uBAAYA,WAAW,KAAG,QAAsB,2FAE7G,4HACA,eACE,GAAM,wBAAsB,yBAE9B,4JAEA,eACE,GAAM,cAAY,eAEpB,0BAAW,uBAAYA,WAAW,KAAG,SAAuB,kQAE5D,6JACA,eACE,GAAM,uBAAqB,wBAE7B,sFAAuE,uBAAYA,WAAW,KAAG,qBAAmC,uBAAuB,uBAAYA,WAAW,KAAG,iBAA+B,+BAA+B,uBAAYA,WAAW,KAAG,aAA2B,OACxS,oGAGJ,CAEAH,EAAWM,gBAAiB,C","sources":["webpack://commerce-pwa-studio/./src/pages/guides/storefront-architecture/build-time/index.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/commerce-pwa-studio/commerce-pwa-studio/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\nconst InlineAlert = makeShortcode(\"InlineAlert\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"build-time-architecture\"\n    }}>{`Build time architecture`}</h1>\n    <p>{`The build architecture of PWA Studio is the system used to compile JavaScript and CSS source code into a production-ready PWA storefront application.`}</p>\n    <h2 {...{\n      \"id\": \"backend-application-dependency\"\n    }}>{`Backend application dependency`}</h2>\n    <p>{`PWA Studio is part of Adobe Commerce's `}<a parentName=\"p\" {...{\n        \"href\": \"https://en.wikipedia.org/wiki/Service-oriented_architecture\"\n      }}>{`service-oriented architecture`}</a>{` vision.\nThis vision minimizes dependencies by separating the merchant-facing store admin and the shopper-facing storefront application.\nSeparating these two applications minimizes the dependencies between them.`}</p>\n    <p>{`The Venia build system respects this principle by running the build process independent from the Adobe Commerce or Magento Open Source core application.\nHowever, the build system does use the application's API at compilation time for additional validation and optimization of storefront code.`}</p>\n    <h2 {...{\n      \"id\": \"repository-organization\"\n    }}>{`Repository organization`}</h2>\n    <p>{`Unlike Adobe Commerce and Magento Open Source themes, the source code for a PWA Studio storefront does not need to be co-located with the application code.\nA PWA Studio storefront and its backend service are two separate applications, so\ntheir codebase is separate from each other.`}</p>\n    <p>{`The Venia concept storefront uses the `}<inlineCode parentName=\"p\">{`yarn`}</inlineCode>{` package for dependency management, but\nstorefronts built using PWA Studio can also use NPM to manage dependencies and run scripts.`}</p>\n    <p>{`Early adopters of PWA Studio have cloned the `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/magento/pwa-studio/\"\n      }}><inlineCode parentName=\"a\">{`pwa-studio`}</inlineCode>{` repository`}</a>{` and made direct customizations to the Venia concept source.\nThis can lead to conflicts when updating to the latest version of the codebase.\nThe preferred approach is to add PWA Studio tools and libraries as dependencies in a project.`}</p>\n    <p>{`The recommended way of getting started is to use the scaffolding tool to `}<a parentName=\"p\" {...{\n        \"href\": \"/tutorials/setup-storefront/\"\n      }}>{`setup a new storefront project`}</a>{`.`}</p>\n    <h2 {...{\n      \"id\": \"build-pipeline\"\n    }}>{`Build pipeline`}</h2>\n    <p>{`The build pipeline is the mechanism that consumes the project source code to generate production-ready files.\nThis process includes code `}<a parentName=\"p\" {...{\n        \"href\": \"https://en.wikipedia.org/wiki/Source-to-source_compiler\"\n      }}>{`transpilation`}</a>{` and smart script bundling.\nLike most modern Web compilation tools, it is built on `}<a parentName=\"p\" {...{\n        \"href\": \"https://nodejs.org/en/about/\"\n      }}>{`NodeJS`}</a>{`.`}</p>\n    <p>{`The main tools used for the build pipeline are `}<a parentName=\"p\" {...{\n        \"href\": \"https://babeljs.io\"\n      }}>{`Babel`}</a>{` and `}<a parentName=\"p\" {...{\n        \"href\": \"https://webpack.js.org/\"\n      }}>{`Webpack`}</a>{`.\nThe Buildpack library provides a convenient API for configuring these tools, but the underlying API for building a PWA is a direct configuration of Babel and Webpack.`}</p>\n    <p>{`The Venia example storefront project contains an opinionated build pipeline setup, using Buildpack's `}<inlineCode parentName=\"p\">{`configureWebpack`}</inlineCode>{` API, but\ndevelopers can also use the PWA-Studio build libraries and configurations to define custom pipelines.`}</p>\n    <h3 {...{\n      \"id\": \"venia-build-steps\"\n    }}>{`Venia build steps`}</h3>\n    <p>{`The following sections provide insight into the processes that make up Venia's build pipeline.`}</p>\n    <h4 {...{\n      \"id\": \"starting-a-build\"\n    }}>{`Starting a build`}</h4>\n    <p>{`Venia's build process begins at the command prompt.\nIt is compatible with OSX and most Linux environments that use a `}<inlineCode parentName=\"p\">{`bash`}</inlineCode>{` shell.`}</p>\n    <p>{`PWA Studio projects use `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.npmjs.com/misc/scripts\"\n      }}>{`NPM scripts`}</a>{` to organize frequently used commands.\nThese `}<inlineCode parentName=\"p\">{`yarn run`}</inlineCode>{` commands are found in the `}<inlineCode parentName=\"p\">{`scripts`}</inlineCode>{` section of the Venia storefront's `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/magento/pwa-studio/blob/develop/packages/venia-concept/package.json\"\n      }}>{`package.json`}</a>{` file.`}</p>\n    <p>{`Use the `}<inlineCode parentName=\"p\">{`build`}</inlineCode>{` command to start the build process:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sh\"\n      }}>{`yarn run build\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"cleanup-step\"\n    }}>{`Cleanup step`}</h4>\n    <p>{`The build process runs a `}<inlineCode parentName=\"p\">{`clean`}</inlineCode>{` script to remove old artifacts from the Venia concept's `}<inlineCode parentName=\"p\">{`dist`}</inlineCode>{` directory before generating the code.`}</p>\n    <h4 {...{\n      \"id\": \"environment-validation\"\n    }}>{`Environment validation`}</h4>\n    <p>{`The next phase uses the `}<inlineCode parentName=\"p\">{`buildpack load-env`}</inlineCode>{` command to load and validate the `}<inlineCode parentName=\"p\">{`.env`}</inlineCode>{` file, which describes the store project configuration.\nThis file is found in the root directory of the Venia concept project.`}</p>\n    <p>{`See `}<a parentName=\"p\" {...{\n        \"href\": \"/guides/general-concepts/configuration/\"\n      }}>{`Configuration management`}</a>{` for more information.`}</p>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`If there is no `}<inlineCode parentName=\"p\">{`.env`}</inlineCode>{` file in your project, create one with the `}<a parentName=\"p\" {...{\n        \"href\": \"/api/buildpack/cli/create-environment-file/\"\n      }}><inlineCode parentName=\"a\">{`buildpack create-env-file`}</inlineCode>{` command`}</a>{`.`}</p>\n    <h4 {...{\n      \"id\": \"query-validation\"\n    }}>{`Query validation`}</h4>\n    <p>{`After the environment validation phase, the build runs the `}<inlineCode parentName=\"p\">{`validate-queries`}</inlineCode>{` script.\nThis script uses the `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/magento/pwa-studio/tree/develop/packages/graphql-cli-validate-magento-pwa-queries\"\n      }}><inlineCode parentName=\"a\">{`graphql-cli-validate-magento-pwa-queries`}</inlineCode></a>{` tool to analyze the GraphQL queries in the project and validates them against the schema downloaded from the configured Magento instance.`}</p>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`The connected Adobe Commerce or Magento Open Source instance is defined by the `}<inlineCode parentName=\"p\">{`MAGENTO_BACKEND_URL`}</inlineCode>{` environment variable.`}</p>\n    <h4 {...{\n      \"id\": \"webpack-execution\"\n    }}>{`Webpack execution`}</h4>\n    <p>{`The final step in the build process uses the webpack CLI (`}<inlineCode parentName=\"p\">{`webpack`}</inlineCode>{`) to process files into bundles.\nThe `}<inlineCode parentName=\"p\">{`webpack.config.js`}</inlineCode>{` file in the storefront project's root configures webpack to use external tools, such as Babel and Workbox, during file processing and bundle creation.`}</p>\n    <p>{`The artifacts generated by webpack are located in the `}<inlineCode parentName=\"p\">{`dist`}</inlineCode>{` folder.\nThese are static files ready to be served from an HTML document's app shell.`}</p>\n    <p>{`When a browser loads these files, it launches a single-page application that is the Venia storefront.`}</p>\n    <h3 {...{\n      \"id\": \"other-build-features\"\n    }}>{`Other build features`}</h3>\n    <p>{`The following build features are used mainly in a development environment.\nThey are not part of the normal production build process.`}</p>\n    <h4 {...{\n      \"id\": \"watch-mode\"\n    }}>{`Watch mode`}</h4>\n    <p>{`The `}<inlineCode parentName=\"p\">{`watch`}</inlineCode>{` script launches a development server and a persistent compiler process that monitors the source code for changes.\nWhen a change is detected, it initiates an incremental rebuild instead of a full build to keep the application in the browser up to date.`}</p>\n    <p>{`This feature allows you to make edits in the code and see the changes in the application without going through the full build process.`}</p>\n    <h4 {...{\n      \"id\": \"linting-and-testing\"\n    }}>{`Linting and testing`}</h4>\n    <p>{`The Venia concept project also contains scripts for formatting (`}<inlineCode parentName=\"p\">{`yarn run prettier`}</inlineCode>{`), style analysis (`}<inlineCode parentName=\"p\">{`yarn run lint`}</inlineCode>{`), and running unit tests (`}<inlineCode parentName=\"p\">{`yarn test`}</inlineCode>{`).`}</p>\n    <p>{`Use these scripts to keep your codebase well-formatted and test functionality.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["name","_frontmatter","InlineAlert","props","console","warn","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","variant","slots","isMDXComponent"],"sourceRoot":""}
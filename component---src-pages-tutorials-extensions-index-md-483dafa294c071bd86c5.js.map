{"version":3,"file":"component---src-pages-tutorials-extensions-index-md-483dafa294c071bd86c5.js","mappings":"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","sources":["webpack://commerce-pwa-studio/./src/pages/tutorials/extensions/index.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/commerce-pwa-studio/commerce-pwa-studio/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\nconst InlineAlert = makeShortcode(\"InlineAlert\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"extension-development\"\n    }}>{`Extension development`}</h1>\n    <p>{`Extensions provide new storefront functionality, extend existing components, or replace different storefront parts.`}</p>\n    <h2 {...{\n      \"id\": \"overview\"\n    }}>{`Overview`}</h2>\n    <p>{`PWA Studio merges third-party code into the final application bundle to build web functionality on top of a base storefront.\nThe `}<a parentName=\"p\" {...{\n        \"href\": \"/guides/general-concepts/extensibility/\"\n      }}>{`extensibility framework`}</a>{` provided by the `}<inlineCode parentName=\"p\">{`pwa-buildpack`}</inlineCode>{` package lets you create these third-party extensions for PWA Studio storefronts, such as Venia.`}</p>\n    <p>{`Extensions can change the behavior of existing components, add new features, or even provide translations.\nLanguage packs are a specific extension type which provide translation data for the `}<a parentName=\"p\" {...{\n        \"href\": \"/guides/general-concepts/internationalization/\"\n      }}>{`internationalization feature`}</a>{`.`}</p>\n    <InlineAlert variant=\"help\" slots=\"text\" mdxType=\"InlineAlert\" />\nSetting up a project workspace that contains both a storefront project and an extension project may result in `buildpack` issues due to dependency conflicts.\nTo solve this, add `@magento/pwa-buildpack` as a dev dependency in the monorepo's `package.json` file.\n    <h2 {...{\n      \"id\": \"project-manifest-file\"\n    }}>{`Project manifest file`}</h2>\n    <p>{`PWA Studio extensions are `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.npmjs.com/about-packages-and-modules\"\n      }}>{`Node packages`}</a>{`, which means it requires a `}<inlineCode parentName=\"p\">{`package.json`}</inlineCode>{` file.\nThe `}<inlineCode parentName=\"p\">{`package.json`}</inlineCode>{` file is the project manifest.\nIt contains metadata about the project, such as the name, entry point, and dependencies.`}</p>\n    <p>{`You can manually create this file, but we recommend using the CLI command `}<a parentName=\"p\" {...{\n        \"href\": \"https://yarnpkg.com/lang/en/docs/cli/init/\"\n      }}><inlineCode parentName=\"a\">{`yarn init`}</inlineCode></a>{` or `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.npmjs.com/cli-commands/init/\"\n      }}><inlineCode parentName=\"a\">{`npm init`}</inlineCode></a>{` in your project directory.\nRunning either command launches an interactive questionnaire to help you fill in your project metadata.`}</p>\n    <h3 {...{\n      \"id\": \"example-manifest-file\"\n    }}>{`Example manifest file`}</h3>\n    <p>{`The following is an example `}<inlineCode parentName=\"p\">{`package.json`}</inlineCode>{` file for an extension called `}<inlineCode parentName=\"p\">{`my-extension`}</inlineCode>{`.\nIt contains both an intercept and declare file under the `}<inlineCode parentName=\"p\">{`src/targets`}</inlineCode>{` directory.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"name\": \"my-extension\",\n  \"version\": \"1.0.0\",\n  \"description\": \"An example extension package\",\n  \"main\": \"src/myList.js\",\n  \"license\": \"MIT\",\n  \"peerDependencies\": {\n    \"react\": \"^17.0.1\"\n  },\n  \"pwa-studio\": {\n    \"targets\": {\n      \"intercept\": \"src/targets/my-intercept\",\n      \"declare\": \"src/targets/my-declare\"\n    }\n  }\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"intercept-and-declare-files\"\n    }}>{`Intercept and declare files`}</h2>\n    <p>{`Extensions use intercept and declare files to interact with the extensibility framework.\nYou can create these files anywhere in your project.\nThe `}<inlineCode parentName=\"p\">{`pwa-studio.targets.intercept`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`pwa-studio.targets.declare`}</inlineCode>{` values in the `}<inlineCode parentName=\"p\">{`package.json`}</inlineCode>{` file point to the locations for these files.`}</p>\n    <p>{`For more information about these files, see the `}<a parentName=\"p\" {...{\n        \"href\": \"/guides/general-concepts/extensibility/\"\n      }}>{`extensibility framework`}</a>{` topic.`}</p>\n    <h2 {...{\n      \"id\": \"create-an-extensions-api\"\n    }}>{`Create an extension's API`}</h2>\n    <p>{`Storefront developers can use Targetables to change the behavior of your extensions, but\nTargets are the formal API for modules and extensions.\nThey are also the only way other third-party extensions can intercept and use your extension's API.`}</p>\n    <h3 {...{\n      \"id\": \"declare-a-target\"\n    }}>{`Declare a Target`}</h3>\n    <p>{`Extensions declare their own Targets for interception through the declare file.\nDeclare files export a function that receives a `}<a parentName=\"p\" {...{\n        \"href\": \"/guides/general-concepts/extensibility/#targetproviders\"\n      }}>{`TargetProvider`}</a>{` object.\nThe TargetProvider object has a `}<inlineCode parentName=\"p\">{`declare()`}</inlineCode>{` function that accepts a dictionary object of named Targets.\nThe TargetProvider also provides a utility collection called `}<inlineCode parentName=\"p\">{`types`}</inlineCode>{`, which holds all the legal constructors for Targets.`}</p>\n    <h4 {...{\n      \"id\": \"example-for-declaring-a-target\"\n    }}>{`Example for declaring a target`}</h4>\n    <p>{`The following is an example of code in a declare file that exposes a `}<inlineCode parentName=\"p\">{`myListContent`}</inlineCode>{` target:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// src/targets/my-declare.js\n\nmodule.exports = (targets) => {\n  targets.declare({\n    myListContent: new targets.types.SyncWaterfall([\"myListContent\"]),\n  });\n};\n`}</code></pre>\n    <p>{`The type for this Target is `}<inlineCode parentName=\"p\">{`SyncWaterfall`}</inlineCode>{`.\nThese Target types run their interceptors synchronously and in subscription order.\nAfter that, they pass the return value as an argument to the next interceptor.`}</p>\n    <p>{`For more information on different Target types, see the documentation for `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/webpack/tapable#hook-types\"\n      }}>{`Hook types`}</a>{` in the Tapable library.`}</p>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`The Tapable hook types end with `}<inlineCode parentName=\"p\">{`Hook`}</inlineCode>{`, but the Target types do not.`}</p>\n    <h3 {...{\n      \"id\": \"define-the-api\"\n    }}>{`Define the API`}</h3>\n    <p>{`The purpose of an extension's API is to provide functions that perform specific and predictable code transformations to files within the extension.\nUse the tools provided by the extensibility framework to define the extension's API in the project's intercept file.`}</p>\n    <h4 {...{\n      \"id\": \"example-for-defining-the-api\"\n    }}>{`Example for defining the API`}</h4>\n    <p>{`The following example defines the `}<inlineCode parentName=\"p\">{`myListContent`}</inlineCode>{` target API from the previous example:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`//src/targets/my-intercept.js\n\n// Get the Targetables manager\nconst { Targetables } = require(\"@magento/pwa-buildpack\");\n\nmodule.exports = (targets) => {\n  // Create a Targetables factory bound to the TargetProvider (targets)\n  const targetables = Targetables.using(targets);\n\n  // Tell the build process to use an esModules loader for this extension\n  targetables.setSpecialFeatures(\"esModules\");\n\n  // Create a TargetableModule instance representing the myList.js file\n  // And provide it a TargetablePublisher to define the API\n  targetables.module(\"my-extension/src/myList.js\", {\n    // Provide a publish() function that accepts the extension's TargetProvider\n    // and an instance of this TargetableModule\n    publish(myTargets, self) {\n      // Define the Target's API\n      const myListContentAPI = {\n        // Define an \\`addContent()\\` function for the API\n        addContent(content) {\n          // Use the \\`insertBeforeSource()\\` function to make source code changes\n          self.insertBeforeSource(\n            \"]; // List content data\",\n            \\`\\\\n\\\\t\\\\t\"\\${content}\",\\`\n          );\n        },\n      };\n      // Connect the API to the \\`myListContent\\` target\n      myTargets.myListContent.call(myListContentAPI);\n    },\n  });\n};\n`}</code></pre>\n    <p>{`For more information on the Targetables API used in this example, see the following reference pages:`}</p>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"/api/buildpack/targetables/TargetableSet/\"\n        }}>{`Targetables manager`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"/api/buildpack/targetables/TargetableModule/\"\n        }}>{`TargetableModule`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"/api/buildpack/targetables/TargetableSet/#TargetablePublisher\"\n        }}>{`TargetablePublisher`}</a></li>\n    </ul>\n    <p>{`The API the `}<inlineCode parentName=\"p\">{`myListContent`}</inlineCode>{` target publishes contains an `}<inlineCode parentName=\"p\">{`addContent()`}</inlineCode>{` function that makes modifications to the `}<inlineCode parentName=\"p\">{`src/myList.js`}</inlineCode>{` file.\nThe content for `}<inlineCode parentName=\"p\">{`src/myList.js`}</inlineCode>{` is as follows:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-jsx\"\n      }}>{`import React from \"react\";\n\nconst MyList = () => {\n  const listContentData = []; // List content data\n\n  const renderedContent = listContentData.map((content) => {\n    return <li key={content}>{content}</li>;\n  });\n\n  return <ul>{renderedContent}</ul>;\n};\n\nexport default MyList;\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"access-an-extensions-api\"\n    }}>{`Access an extension's API`}</h2>\n    <p>{`Using the `}<em parentName=\"p\">{`MyList`}</em>{` component in your storefront with no modifications renders an empty list.\nTo add content, the storefront project or a third party extension must intercept and tap into the `}<inlineCode parentName=\"p\">{`myListContent`}</inlineCode>{` target to access the API.`}</p>\n    <p>{`The following shows how a storefront or third part extension can access and use that API in their intercept file:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// intercept.js\n\nconst { Targetables } = require(\"@magento/pwa-buildpack\");\n\nfunction localIntercept(targets) {\n  const targetables = Targetables.using(targets);\n\n  targets.of(\"my-extension\").myListContent.tap((api) => {\n    api.addContent(\"Hello\");\n    api.addContent(\"World\");\n  });\n}\n\nmodule.exports = localIntercept;\n`}</code></pre>\n    <p>{`Now, when the MyList component renders, it contains the two list entries added through the API.`}</p>\n    <h2 {...{\n      \"id\": \"project-dependencies\"\n    }}>{`Project dependencies`}</h2>\n    <p>{`If your extension needs third-party libraries, you can `}<a parentName=\"p\" {...{\n        \"href\": \"https://classic.yarnpkg.com/en/docs/cli/add/\"\n      }}>{`add them as dependencies`}</a>{`.\nPWA Studio extensions are Node packages, so most of their dependencies should be `}<a parentName=\"p\" {...{\n        \"href\": \"https://classic.yarnpkg.com/en/docs/dependency-types#toc-peerdependencies\"\n      }}>{`peer dependencies`}</a>{`.\nStorefront developers should make sure their project has the dependencies an extension requires.\nThis safeguards against duplicate copies of the same library in the final application bundle.`}</p>\n    <h2 {...{\n      \"id\": \"install-and-test-locally\"\n    }}>{`Install and test locally`}</h2>\n    <p>{`To install and test your extension on a local storefront project, add the extension as a local dependency or list it as a build dependency.`}</p>\n    <h3 {...{\n      \"id\": \"adding-as-a-local-dependency\"\n    }}>{`Adding as a local dependency`}</h3>\n    <p>{`The `}<inlineCode parentName=\"p\">{`package.json`}</inlineCode>{` file lets you specify a local path instead of a version for a dependency.\nThis tells the package manager to install that package from that local path instead of searching online.\nA local dependency in your storefront project's `}<inlineCode parentName=\"p\">{`package.json`}</inlineCode>{` file looks like the following:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"dependencies\": {\n    \"my-extension\": \"file:../relative/path/to/my-extension\"\n  }\n}\n`}</code></pre>\n    <p>{`Use the `}<inlineCode parentName=\"p\">{`yarn`}</inlineCode>{` or `}<inlineCode parentName=\"p\">{`npm`}</inlineCode>{` command to add this entry to the `}<inlineCode parentName=\"p\">{`package.json`}</inlineCode>{` file:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sh\"\n      }}>{`yarn add file:../relative/path/to/my-extension\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sh\"\n      }}>{`npm install -S ../relative/path/to/my-extension\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"adding-as-a-build-dependency\"\n    }}>{`Adding as a build dependency`}</h3>\n    <p>{`Buildpack provides an alternate way of installing a local extensions by linking it to Yarn's or NPM's global package set and listing it in the `}<inlineCode parentName=\"p\">{`BUILDBUS_DEPS_ADDITIONAL`}</inlineCode>{` environment variable.`}</p>\n    <p>{`Use the `}<a parentName=\"p\" {...{\n        \"href\": \"https://classic.yarnpkg.com/en/docs/cli/link/\"\n      }}><inlineCode parentName=\"a\">{`yarn link`}</inlineCode></a>{` or `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.npmjs.com/cli/v6/commands/npm-link\"\n      }}><inlineCode parentName=\"a\">{`npm link`}</inlineCode></a>{` command in your extension project to symlink it to the global package set.`}</p>\n    <p>{`In your storefront project, run `}<inlineCode parentName=\"p\">{`yarn link <package-name>`}</inlineCode>{` or `}<inlineCode parentName=\"p\">{`npm link <package-name>`}</inlineCode>{` to link the two packages together.\nThis lets Node and Webpack resolve your extension from the storefront project without adding it as an entry in the dependency array.`}</p>\n    <p>{`Edit your storefront project's `}<inlineCode parentName=\"p\">{`.env`}</inlineCode>{` file and add your extension's name to the comma-separated value for `}<inlineCode parentName=\"p\">{`BUILDBUS_DEPS_ADDITIONAL`}</inlineCode>{`.\nThis tells the build process that it should check these packages for intercept and declare files.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["name","_frontmatter","InlineAlert","props","console","warn","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","variant","slots","isMDXComponent"],"sourceRoot":""}
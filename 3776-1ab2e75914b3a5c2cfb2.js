(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[3776],{73776:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return k}});var o,r,i,c,a,s=t(15007),u=t(95926);!function(e){e.Call="call",e.Reply="reply",e.Syn="syn",e.SynAck="synAck",e.Ack="ack"}(o||(o={})),function(e){e.Fulfilled="fulfilled",e.Rejected="rejected"}(r||(r={})),function(e){e.ConnectionDestroyed="ConnectionDestroyed",e.ConnectionTimeout="ConnectionTimeout",e.NotInIframe="NotInIframe",e.NoIframeSrc="NoIframeSrc"}(i||(i={})),function(e){e.DataCloneError="DataCloneError"}(c||(c={})),function(e){e.Message="message"}(a||(a={}));var d={"http:":"80","https:":"443"},l=/^(https?:)?\/\/([^/:]+)?(:(\d+))?/,f=["file:","data:"],g=function(e){return{name:e.name,message:e.message,stack:e.stack}},m=function(e){var n=new Error;return Object.keys(e).forEach((function(t){return n[t]=e[t]})),n},v=0,h=function(){return++v},p=function(e,n,t,c,s){var u=n.localName,d=n.local,l=n.remote,f=n.originForSending,g=n.originForReceiving,v=!1;s("".concat(u,": Connecting call sender"));return t.reduce((function(e,n){return e[n]=function(e){return function(){for(var n=arguments.length,t=new Array(n),p=0;p<n;p++)t[p]=arguments[p];var y;s("".concat(u,": Sending ").concat(e,"() call"));try{l.closed&&(y=!0)}catch(C){y=!0}if(y&&c(),v){var w=new Error("Unable to send ".concat(e,"() call due ")+"to destroyed connection");throw w.code=i.ConnectionDestroyed,w}return new Promise((function(n,i){var c=h();d.addEventListener(a.Message,(function t(f){if(f.source===l&&f.data.penpal===o.Reply&&f.data.id===c)if(f.origin===g){var v=f.data;s("".concat(u,": Received ").concat(e,"() reply")),d.removeEventListener(a.Message,t);var h=v.returnValue;v.returnValueIsError&&(h=m(h)),(v.resolution===r.Fulfilled?n:i)(h)}else s("".concat(u," received message from origin ").concat(f.origin," which did not match expected origin ").concat(g))}));var v={penpal:o.Call,id:c,methodName:e,args:t};l.postMessage(v,f)}))}}(n),e}),e),function(){v=!0}},y=function(e,n,t,i,s){var u,d,l=i.destroy,f=i.onDestroy,m={};return function(i){if(i.origin===n){s("Parent: Handshake - Received ACK");var v={localName:"Parent",local:window,remote:i.source,originForSending:t,originForReceiving:n};u&&u(),u=function(e,n,t){var i=e.localName,s=e.local,u=e.remote,d=e.originForSending,l=e.originForReceiving,f=!1,m=function(e){if(e.source===u&&e.data.penpal===o.Call)if(e.origin===l){var a=e.data,s=a.methodName,m=a.args,v=a.id;t("".concat(i,": Received ").concat(s,"() call"));var h=function(e){return function(n){if(t("".concat(i,": Sending ").concat(s,"() reply")),f)t("".concat(i,": Unable to send ").concat(s,"() reply due to destroyed connection"));else{var a={penpal:o.Reply,id:v,resolution:e,returnValue:n};e===r.Rejected&&n instanceof Error&&(a.returnValue=g(n),a.returnValueIsError=!0);try{u.postMessage(a,d)}catch(m){if(m.name===c.DataCloneError){var l={penpal:o.Reply,id:v,resolution:r.Rejected,returnValue:g(m),returnValueIsError:!0};u.postMessage(l,d)}throw m}}}};new Promise((function(e){return e(n[s].apply(n,m))})).then(h(r.Fulfilled),h(r.Rejected))}else t("".concat(i," received message from origin ").concat(e.origin," which did not match expected origin ").concat(l))};return s.addEventListener(a.Message,m),function(){f=!0,s.removeEventListener(a.Message,m)}}(v,e,s),f(u),d&&d.forEach((function(e){delete m[e]})),d=i.data.methodNames;var h=p(m,v,d,l,s);return f(h),m}s("Parent: Handshake - Received ACK message from origin ".concat(i.origin," which did not match expected origin ").concat(n))}},w=function(e){var n,t,r=e.iframe,c=e.methods,s=void 0===c?{}:c,u=e.childOrigin,g=e.timeout,m=e.debug,v=function(e){return function(){if(e){for(var n,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];(n=console).log.apply(n,["[Penpal]"].concat(o))}}}(void 0!==m&&m),h=(n=[],t=!1,{destroy:function(e){t=!0,n.forEach((function(n){n(e)}))},onDestroy:function(e){t?e():n.push(e)}}),p=h.onDestroy,w=h.destroy;u||(!function(e){if(!e.src&&!e.srcdoc){var n=new Error("Iframe must have src or srcdoc property defined.");throw n.code=i.NoIframeSrc,n}}(r),u=function(e){if(e&&f.find((function(n){return e.startsWith(n)})))return"null";var n,t,o,r=document.location,i=l.exec(e);i?(n=i[1]?i[1]:r.protocol,t=i[2],o=i[4]):(n=r.protocol,t=r.hostname,o=r.port);var c=o&&o!==d[n]?":".concat(o):"";return"".concat(n,"//").concat(t).concat(c)}(r.src));var C="null"===u?"*":u,I=function(e,n,t,r){return function(i){if(i.origin===t){e("Parent: Handshake - Received SYN, responding with SYN-ACK");var c={penpal:o.SynAck,methodNames:Object.keys(n)};i.source.postMessage(c,r)}else e("Parent: Handshake - Received SYN message from origin ".concat(i.origin," which did not match expected origin ").concat(t))}}(v,s,u,C),S=y(s,u,C,h,v);return{promise:new Promise((function(e,n){var t=function(e,n){var t;return void 0!==e&&(t=window.setTimeout((function(){var t=new Error("Connection timed out after ".concat(e,"ms"));t.code=i.ConnectionTimeout,n(t)}),e)),function(){clearTimeout(t)}}(g,w),c=function(n){if(n.source===r.contentWindow&&n.data)if(n.data.penpal!==o.Syn)if(n.data.penpal!==o.Ack);else{var i=S(n);i&&(t(),e(i))}else I(n)};window.addEventListener(a.Message,c),v("Parent: Awaiting handshake"),function(e,n){var t=n.destroy,o=n.onDestroy,r=setInterval((function(){e.isConnected||(clearInterval(r),t())}),6e4);o((function(){clearInterval(r)}))}(r,h),p((function(e){window.removeEventListener(a.Message,c),e||((e=new Error("Connection destroyed")).code=i.ConnectionDestroyed),n(e)}))})),destroy:function(){w()}}},C=t(38094),I=t(74117),S=t(37791),k=function(e){var n=e.src,t=e.height,o=void 0===t?"calc(100vh - var(--spectrum-global-dimension-size-800))":t,r=(0,s.useState)(!0),i=r[0],c=r[1],a=(0,s.useRef)(null),d=(0,s.useContext)(S.Z).ims;return(0,u.tZ)(s.default.Fragment,null,(0,u.tZ)("div",{css:(0,u.iv)("position:fixed;top:0;left:0;right:0;bottom:0;display:",i?"grid":"none",";place-items:center center;","")},(0,u.tZ)(I._,{size:"L"})),(0,u.tZ)("iframe",{ref:a,src:n,onLoad:function(){c(!1),w({iframe:a.current,methods:{getURL:function(){return location.href},setHeight:function(e){a.current.style.height=e},getIMSAccessToken:function(){return null!=d&&d.isSignedInUser()?d.getAccessToken():null},getIMSProfile:function(){return null!=d&&d.isSignedInUser()?d.getProfile():null},signIn:function(){d&&!d.isSignedInUser()&&d.signIn()},signOut:function(){d&&d.isSignedInUser()&&d.signOut()}}})},css:(0,u.iv)("height:",o,";width:100%;border:none;","")}),(0,u.tZ)(C.$,null))}}}]);
//# sourceMappingURL=3776-1ab2e75914b3a5c2cfb2.js.map
{"version":3,"file":"component---src-pages-tutorials-events-custom-events-index-md-66abc0bb6848e981070d.js","mappings":"4RAMaA,EAAe,CAAC,EACvBC,EAAc,CAClBD,aAAAA,GAEIE,EAAYC,EAAAA,EACH,SAASC,EAAW,GAGhC,IAFDC,EAAU,EAAVA,WACGC,GAAK,YAER,OAAO,SAACJ,GAAS,UAAKD,EAAiBK,EAAK,CAAED,WAAYA,EAAYE,QAAQ,eAG5E,eACE,GAAM,0BAAwB,2BAEhC,+TAEA,6DAA8C,cAAGC,WAAW,IACxD,KAAQ,yGAAuG,2CAC/D,6CACpD,kDAAmC,uBAAYA,WAAW,KAAG,mBAAiC,qIAC9F,iHACA,eACE,GAAM,4BAA0B,8BAElC,gFACA,oBACE,eAAIA,WAAW,OAAK,uBAAYA,WAAW,MAAI,eAA6B,0FAA0F,uBAAYA,WAAW,MAAI,QAAsB,YAAY,uBAAYA,WAAW,MAAI,YAA0B,gDACxR,eAAIA,WAAW,OAAK,uBAAYA,WAAW,MAAI,YAA0B,6CAE3E,qBAAK,iBAAMA,WAAW,MAClB,UAAa,uBAAqB,k1BAyCtC,eACE,GAAM,yBAAuB,2BAE/B,qCAAsB,cAAGA,WAAW,IAChC,KAAQ,2FAAyF,iBAC3E,2BAA2B,uBAAYA,WAAW,KAAG,qBAAmC,0DACjH,uBAAYA,WAAW,KAAG,0BAAwC,kGAAkG,uBAAYA,WAAW,KAAG,aAA2B,eAC1N,qBAAK,iBAAMA,WAAW,MAClB,UAAa,uBAAqB,86CAkDtC,sCAAuB,cAAGA,WAAW,IACjC,KAAQ,0FAAwF,4BAC/D,MACrC,eACE,GAAM,eAAa,iBAErB,6JAC2B,uBAAYA,WAAW,KAAG,YAA0B,MAAM,uBAAYA,WAAW,KAAG,oBAAkC,UAAU,uBAAYA,WAAW,KAAG,qBAAmC,oEACxN,qBAAK,iBAAMA,WAAW,MAClB,UAAa,uBAAqB,2ZAUtC,0DAA2C,cAAGA,WAAW,IACrD,KAAQ,oHAAkH,4BACzF,KAGzC,CAEAJ,EAAWK,gBAAiB,C","sources":["webpack://commerce-pwa-studio/./src/pages/tutorials/events/custom-events/index.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/commerce-pwa-studio/commerce-pwa-studio/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"creating-custom-events\"\n    }}>{`Creating custom events`}</h1>\n    <p>{`The eventing framework introduced in the PWA Studio 12.5 release comes with a core set of storefront events related to various interactions with the application.\nYou can use PWA Studio's extensibility framework to modify your storefront and have it publish events not covered by the default set.`}</p>\n    <p>{`PWA Studio provides the source for the `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/magento/pwa-studio/tree/develop/packages/extensions/experience-platform-connector/\"\n      }}>{`Experience Platform Connector extension`}</a>{` to show how you can add a custom event.`}</p>\n    <p>{`This extension dispatches a `}<inlineCode parentName=\"p\">{`SEARCH_RESPONSE`}</inlineCode>{` event, which is not part of the default set. This event fires when a search result is returned in the application's search bar.`}</p>\n    <p>{`These files show the different pieces and logic you need to create your own custom events.`}</p>\n    <h2 {...{\n      \"id\": \"searchresponsereceivedjs\"\n    }}>{`searchResponseReceived.js`}</h2>\n    <p>{`This file is an event handler that returns two functions:`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`canHandle()`}</inlineCode>{` - a function that receives an event from PWA Studio's eventing framework and returns `}<inlineCode parentName=\"li\">{`true`}</inlineCode>{` if the `}<inlineCode parentName=\"li\">{`handle()`}</inlineCode>{` function should handle the incoming event.`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`handle()`}</inlineCode>{` - the function that handles the event.`}</li>\n    </ul>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`const canHandle = event => event.type === 'SEARCH_RESPONSE';\n\nconst handle = (sdk, event) => {\n    const { payload } = event;\n\n    const {\n        categories,\n        facets,\n        page,\n        perPage,\n        products,\n        searchRequestId,\n        searchUnitId,\n        suggestions\n    } = payload;\n\n    const searchResultsContext = {\n        units: [\n            {\n                categories,\n                facets,\n                page,\n                perPage,\n                products,\n                searchRequestId,\n                searchUnitId,\n                suggestions\n            }\n        ]\n    };\n\n    sdk.context.setSearchResults(searchResultsContext);\n    sdk.publish.searchResponseReceived(searchUnitId, searchResultsContext);\n};\n\nexport default {\n    canHandle,\n    handle\n};\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"wrapuseautocompletejs\"\n    }}>{`wrapUseAutocomplete.js`}</h2>\n    <p>{`This file is a `}<a parentName=\"p\" {...{\n        \"href\": \"https://developer.adobe.com/commerce/pwa-studio/tutorials/targets/modify-talon-results/\"\n      }}>{`talon wrapper`}</a>{` that wraps around the `}<inlineCode parentName=\"p\">{`useAutocomplete()`}</inlineCode>{` talon to add additional event dispatching logic.\nIn `}<inlineCode parentName=\"p\">{`wrapUseAutocomplete.js`}</inlineCode>{` the search result is received and the payload defined and dispatched. This take place in the `}<inlineCode parentName=\"p\">{`useEffect`}</inlineCode>{` function:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`import { useEffect } from 'react';\nimport { useEventingContext } from '@magento/peregrine/lib/context/eventing';\n\n// Wrapper for the useAutocomplete() talon\nconst wrapUseAutocomplete = useAutocomplete => {\n    return props => {\n        const talonProps = useAutocomplete(props);\n        const [, { dispatch }] = useEventingContext();\n\n        const {\n            categories,\n            displayResult,\n            messageType,\n            value,\n            ...restProps\n        } = talonProps;\n\n        useEffect(() => {\n            if (\n                messageType === 'RESULT_SUMMARY' ||\n                messageType === 'EMPTY_RESULT'\n            ) {\n                dispatch({\n                    type: 'SEARCH_RESPONSE',\n                    payload: {\n                        categories: categories || [],\n                        facets: [],\n                        page: 1,\n                        perPage: 3, // Same value used in GQL query\n                        products: displayResult || [],\n                        searchRequestId: value,\n                        searchUnitId: 'search-bar',\n                        suggestions: displayResult || []\n                    }\n                });\n            }\n        });\n\n        return {\n            displayResult,\n            messageType,\n            value,\n            ...restProps\n        };\n    };\n};\n\nexport default wrapUseAutocomplete;\n`}</code></pre>\n    <p>{`Read more about `}<a parentName=\"p\" {...{\n        \"href\": \"https://developer.adobe.com/commerce/pwa-studio/guides/general-concepts/extensibility/\"\n      }}>{`PWA Studio extensibility`}</a>{`.`}</p>\n    <h2 {...{\n      \"id\": \"interceptjs\"\n    }}>{`intercept.js`}</h2>\n    <p>{`The intercept file interacts with PWA Studio's extensibility framework to modify code during build time.\nIn this particular code, the `}<inlineCode parentName=\"p\">{`useApp()`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`useAccountMenu()`}</inlineCode>{`, and `}<inlineCode parentName=\"p\">{`useAutocomplete()`}</inlineCode>{` talons are wrapped with modules that provide additional logic.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`    talons.tap(({ App, Header, SearchBar }) => {\n        App.useApp.wrapWith('@magento/experience-platform-connector');\n        Header.useAccountMenu.wrapWith(\n            '@magento/experience-platform-connector/src/wrappers/wrapUseAccountMenu'\n        );\n        SearchBar.useAutocomplete.wrapWith(\n            '@magento/experience-platform-connector/src/wrappers/wrapUseAutocomplete'\n        );\n`}</code></pre>\n    <p>{`When your code is complete, you can `}<a parentName=\"p\" {...{\n        \"href\": \"https://developer.adobe.com/commerce/pwa-studio/tutorials/targets/modify-talon-results/#test-on-a-local-instance\"\n      }}>{`test on a local instance`}</a>{`.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"sourceRoot":""}
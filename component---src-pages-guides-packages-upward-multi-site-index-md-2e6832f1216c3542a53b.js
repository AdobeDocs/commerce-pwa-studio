"use strict";(self.webpackChunkcommerce_pwa_studio=self.webpackChunkcommerce_pwa_studio||[]).push([[3472],{322:function(e,n,t){t.r(n),t.d(n,{_frontmatter:function(){return d},default:function(){return m}});var o=t(87462),a=t(45987),i=(t(35776),t(3905)),s=t(91515);const r=["components"],d={},l={_frontmatter:d},p=s.Z;function m(e){let{components:n}=e,t=(0,a.Z)(e,r);return(0,i.mdx)(p,(0,o.Z)({},l,t,{components:n,mdxType:"MDXLayout"}),(0,i.mdx)("h1",{id:"multiple-websites-with-upward"},"Multiple websites with UPWARD"),(0,i.mdx)("p",null,"This topic describes how to configure your UPWARD server to run multiple PWA sites from a single Magento Open Source or Adobe Commerce backend."),(0,i.mdx)("h2",{id:"the-upward-connector-module"},"The UPWARD connector module"),(0,i.mdx)("p",null,"When you use the PWA scaffolding tool to create a PWA Studio project, one of the many modules installed is the UPWARD PHP connector moduleâ€”",(0,i.mdx)("inlineCode",{parentName:"p"},"magento2-upward-connector"),". This module provides a CLI to help you configure different PWA sites to run from a single Commerce or Open Source server."),(0,i.mdx)("h2",{id:"configuring-the-upward-server"},"Configuring the UPWARD server"),(0,i.mdx)("p",null,"The first step is to configure the UPWARD server to access the different PWA sites you want to deploy. And the CLI provided by the UPWARD module is how you do it."),(0,i.mdx)("p",null,"But before we get to the specifics, here's the overview of what you are actually doing. When you execute the CLI commands, you're actually adding ",(0,i.mdx)("inlineCode",{parentName:"p"},"pwa_paths")," to the ",(0,i.mdx)("inlineCode",{parentName:"p"},"env.php")," file. The commands specify the paths to the ",(0,i.mdx)("inlineCode",{parentName:"p"},"upward.yml")," configuration for each PWA site you want to deploy. The following  example shows what an ",(0,i.mdx)("inlineCode",{parentName:"p"},"env.php")," configuration file may look like AFTER using the CLI to add two different PWA sites to the ",(0,i.mdx)("inlineCode",{parentName:"p"},"default")," and ",(0,i.mdx)("inlineCode",{parentName:"p"},"website")," configurations:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-php"},"// ...\n'downloadable_domains' => [\n    // ...\n],\n# New configuration point\n'pwa_path' => [\n    'default' => [\n        'default' => '/var/www/html/my-pwa-site/dist/upward.yml'\n    ],\n    'website' => [\n        '<website_code>' => '/var/www/html/my-awesome-pwa-site/dist/upward.yml'\n    ],\n    'store' => [\n        '<store_code>' => '' # Setting an empty string (or `false` value) will serve the specified default site (my-pwa-site)\n    ]\n]\n")),(0,i.mdx)("h2",{id:"using-upward-cli-commands"},"Using UPWARD CLI commands"),(0,i.mdx)("p",null,"The UPWARD module commands provide a convenient way to configure the server to deploy different PWA sites. The following examples show common usage patterns."),(0,i.mdx)("p",null,(0,i.mdx)("strong",{parentName:"p"},"Set UPWARD paths with ",(0,i.mdx)("inlineCode",{parentName:"strong"},"scopeType")," and ",(0,i.mdx)("inlineCode",{parentName:"strong"},"scopeCode"),":")),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-shell"},"bin/magento pwa:upward:set --path /var/www/html/pwa/dist/upward.yml --scopeType store --scopeCode <store_code>\n")),(0,i.mdx)("p",null,"To find the paths of your PWA sites (by scope) as shown above for the store scope, use one of the following commands:"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"bin/magento store:list")," (for store scope)"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"bin/magento store:website:list")," (for store and website scopes)")),(0,i.mdx)("p",null,"Paths to ",(0,i.mdx)("inlineCode",{parentName:"p"},"upward.yml")," can be relative: ",(0,i.mdx)("inlineCode",{parentName:"p"},"pwa/dist/upward.yml")," or absolute: ",(0,i.mdx)("inlineCode",{parentName:"p"},"/var/www/html/pwa/dist/upward.yml"),"."),(0,i.mdx)("p",null,"To serve the default store front (non-PWA), use an empty string:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-shell"},"bin/magento pwa:upward:set\n")),(0,i.mdx)("p",null,"The UPWARD path configurations work the same as other store configurations: The config settings fall up in scope from ",(0,i.mdx)("inlineCode",{parentName:"p"},"store")," > ",(0,i.mdx)("inlineCode",{parentName:"p"},"website")," > ",(0,i.mdx)("inlineCode",{parentName:"p"},"global")," (default), trying to serve the most specific, available site scope first."),(0,i.mdx)("h2",{id:"creating-multiple-bundles"},"Creating multiple bundles"),(0,i.mdx)("p",null,"You can also generate unique bundles per website within a single scaffolded project."),(0,i.mdx)("p",null,"For example, if you want to deploy both French and German versions of your site, you could use the following commands to configure your UPWARD server:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-shell"},"MAGENTO_BACKEND_URL=https://french.mysite.mg yarn build\nmv dist dist-french\nMAGENTO_BACKEND_URL=https://german.mysite.mg yarn build\nmv dist dist-german\n \n# copy these bundles to your Magento root and set configuration variables\nbin/magento pwa:upward:set --path ./dist-french/upward.yml --scopeType website --scopeCode fr\nbin/magento pwa:upward:set --path ./dist-german/upward.yml --scopeType website --scopeCode de\n")),(0,i.mdx)("p",null,"With this configuration, a single UPWARD server can process requests for many different website bundles."))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-packages-upward-multi-site-index-md-2e6832f1216c3542a53b.js.map
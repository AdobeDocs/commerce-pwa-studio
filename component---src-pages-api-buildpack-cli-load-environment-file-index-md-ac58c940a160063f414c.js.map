{"version":3,"sources":["webpack://dev-site-documentation-template/./src/pages/api/buildpack/cli/load-environment-file/index.md"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-api-buildpack-cli-load-environment-file-index-md-ac58c940a160063f414c.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/commerce-pwa-studio/commerce-pwa-studio/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"load-environment-file\"\n    }}>{`Load environment file`}</h1>\n    <p>{`The `}<inlineCode parentName=\"p\">{`load-env`}</inlineCode>{` subcommand for the `}<a parentName=\"p\" {...{\n        \"href\": \"/commerce-pwa-studio/api/buildpack/cli/\"\n      }}><inlineCode parentName=\"a\">{`buildpack`}</inlineCode></a>{` CLI command loads and validates the local `}<inlineCode parentName=\"p\">{`.env`}</inlineCode>{` file according to the variable declarations in the `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/magento/pwa-studio/blob/develop/packages/pwa-buildpack/envVarDefinitions.json\"\n      }}><inlineCode parentName=\"a\">{`envVarDefinitions.json`}</inlineCode></a>{` file.\nThis includes any deprecated or changed settings.\nWhen loading from `}<inlineCode parentName=\"p\">{`.env`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`buildpack`}</inlineCode>{` does not override previously declared variables.`}</p>\n    <h2 {...{\n      \"id\": \"command-flags\"\n    }}>{`Command flags`}</h2>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Name`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`--core-dev-mode`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Used only by the core PWA Studio repository for quick setups of the core dev environment.`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`The `}<inlineCode parentName=\"p\">{`--core-dev-mode`}</inlineCode>{` flag tells `}<inlineCode parentName=\"p\">{`buildpack`}</inlineCode>{` to run `}<inlineCode parentName=\"p\">{`buildpack create-env-file --use-examples`}</inlineCode>{` if an existing `}<inlineCode parentName=\"p\">{`.env`}</inlineCode>{` file does not exist in the given directory path.`}</p>\n    <h2 {...{\n      \"id\": \"usage-tips\"\n    }}>{`Usage tips`}</h2>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Use the `}<inlineCode parentName=\"p\">{`load-env`}</inlineCode>{` command in NPM scripts instead of directly invoking it with `}<inlineCode parentName=\"p\">{`npx`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Use a command, shell script, or spawned subprocess to override individual environment variables at start time.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`The command does not require a `}<inlineCode parentName=\"p\">{`.env`}</inlineCode>{` file to be present.`}</p>\n        <p parentName=\"li\">{`If a `}<inlineCode parentName=\"p\">{`.env`}</inlineCode>{` file is not present, the environment is still valid if another process or command sets the required variables.\nIf the file is not present and the variable `}<inlineCode parentName=\"p\">{`NODE_ENV`}</inlineCode>{` is not set to `}<inlineCode parentName=\"p\">{`production`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`buildpack`}</inlineCode>{` logs a warning.`}</p>\n      </li>\n    </ul>\n    <h2 {...{\n      \"id\": \"programmatic-api\"\n    }}>{`Programmatic API`}</h2>\n    <p>{`Adding the `}<inlineCode parentName=\"p\">{`@magento/pwa-buildpack`}</inlineCode>{` dependency to your project gives you access to the programmatic API for loading the `}<inlineCode parentName=\"p\">{`.env`}</inlineCode>{` file.`}</p>\n    <h3 {...{\n      \"id\": \"loadenvironmentdirorenv-logger\"\n    }}><inlineCode parentName=\"h3\">{`loadEnvironment(dirOrEnv, [logger])`}</inlineCode></h3>\n    <p>{`Loads a given directory's `}<inlineCode parentName=\"p\">{`.env`}</inlineCode>{` file and provides a `}<a parentName=\"p\" {...{\n        \"href\": \"/commerce-pwa-studio/guides/general-concepts/configuration/\"\n      }}>{`configuration object`}</a>{`.`}</p>\n    <h4 {...{\n      \"id\": \"example\"\n    }}>{`Example`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`const { loadEnvironment } = require(\"@magento/pwa-buildpack\");\n\nconst configuration = await loadEnvironment(process.cwd());\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"parameters\"\n    }}>{`Parameters`}</h4>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Name`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Data type`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`dirOrEnv`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`string`}</inlineCode>{` path or `}<inlineCode parentName=\"td\">{`process.env`}</inlineCode>{` object`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Provides a path to the project root.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`logger`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`object`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`An optional logger object to use instead of the default console.`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`If the `}<inlineCode parentName=\"p\">{`dirOrEnv`}</inlineCode>{` parameter is a `}<inlineCode parentName=\"p\">{`process.env`}</inlineCode>{` object, it will not attempt to parse a `}<inlineCode parentName=\"p\">{`.env`}</inlineCode>{` file.`}</p>\n    <h4 {...{\n      \"id\": \"return-value\"\n    }}>{`Return value`}</h4>\n    <p>{`The `}<inlineCode parentName=\"p\">{`loadEnvironment()`}</inlineCode>{` function returns a configuration object.`}</p>\n    <h3 {...{\n      \"id\": \"configuration-object\"\n    }}>{`Configuration object`}</h3>\n    <p>{`Use the configuration object returned by `}<inlineCode parentName=\"p\">{`loadEnvironment()`}</inlineCode>{` as a single source of truth for configuration.`}</p>\n    <h4 {...{\n      \"id\": \"properties\"\n    }}>{`Properties`}</h4>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Name`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": \"center\"\n          }}>{`Alias`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`env`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": \"center\"\n          }}>{`-`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The raw environment object`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`isProduction`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": \"center\"\n          }}><inlineCode parentName=\"td\">{`isProd`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`True if `}<inlineCode parentName=\"td\">{`NODE_ENV=production`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`isDevelopment`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": \"center\"\n          }}><inlineCode parentName=\"td\">{`isDev`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`True if `}<inlineCode parentName=\"td\">{`NODE_ENV=development`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`isTest`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": \"center\"\n          }}>{`-`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`True if `}<inlineCode parentName=\"td\">{`NODE_ENV=test`}</inlineCode></td>\n        </tr>\n      </tbody>\n    </table>\n    <h4 {...{\n      \"id\": \"methods\"\n    }}>{`Methods`}</h4>\n    <p>{`The configuration object provides methods that return settings in specific namespaces.\nThis lets you pass smaller objects instead of a single, plain object full of global configuration values.`}</p>\n    <p><inlineCode parentName=\"p\">{`section(sectionName)`}</inlineCode>{`\n: Returns a plain object with environment variables in the `}<inlineCode parentName=\"p\">{`sectionName`}</inlineCode>{` namespace.\nThe property keys are `}<a parentName=\"p\" {...{\n        \"href\": \"https://npmjs.com/package/camelspace\"\n      }}>{`camelCased`}</a>{` for convenience.`}</p>\n    <p><inlineCode parentName=\"p\">{`sections(...sectionNames)`}</inlineCode>{`\n: Returns a plain object with environment variables from the specified namespaces.\nThe namespaces are assigned to different camelCased properties named after the section name.`}</p>\n    <p><inlineCode parentName=\"p\">{`all()`}</inlineCode>{`\n: Returns the entire environment object, camelCased for convenience, with no namespace separations.`}</p>\n    <h3 {...{\n      \"id\": \"full-example-script\"\n    }}>{`Full example script`}</h3>\n    <p>{`The following example is a script that starts an `}<a parentName=\"p\" {...{\n        \"href\": \"/commerce-pwa-studio/guides/packages/upward/javascript/\"\n      }}>{`UPWARD-JS`}</a>{` server using configuration values loaded from the environment and `}<inlineCode parentName=\"p\">{`.env`}</inlineCode>{` file in the project path.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import { loadEnvironment } from \"@magento/pwa-buildpack\";\n\n// Give \\`loadEnvironment\\` the path to the project root.\n// If the current file is in project root, use the Node builtin \\`__dirname\\`.\nconst configuration = await loadEnvironment(\"/Users/me/path/to/project\");\n\n// \\`loadEnvironment\\` has now read the contents of\n// \\`/Users/me/path/to/project/.env\\` and merged it with any environment\n// variables that were alredy set.\n\n// Create an UPWARD server using env vars that begin with \\`UPWARD_JS_\\`\ncreateUpwardServer(configuration.section(\"upwardJs\"));\n\n// If these environment variables are set:\n//\n// UPWARD_JS_HOST=https://local.upward/\n// UPWARD_JS_PORT=8081\n//\n// then \\`configuration.section('upwardJs')\\` produces this object:\n//\n// {\n//   host: 'https://local.upward',\n//   port: '8081'\n// }\n//\n// No other environment variables are included in this object unless they begin\n// with \\`UPWARD_JS_\\` which is the equivalent of \\`upwardJs\\` camel-cased.\n\n// The .all() method turns the whole environment into an object, with all\n// CONSTANT_CASE names turned into camelCase names.\nconst allConfig = configuration.all();\n\n// This object will have one property for each set environment variable,\n// including the UPWARD variables named above.\n// But \\`configuration.all()\\` does not namespace them, they have longer names:\n//\n// {\n//   upwardJsHost: 'https://local.upward',\n//   upwardJsPort: '8081'\n// }\n//\n// This huge object defeats the purpose of loadEnvironment() and should\n// only be used for debugging.\n\n// Instead, let's create an UPWARD server combining two environment variable\n// sections with hardcoded overrides to some values.\ncreateUpwardServer({\n  ...configuration.section(\"upwardJs\"),\n  ...configuration.section(\"magento\"),\n  bindLocal: true,\n});\n\n// This uses JavaScript object spreading to combine several sections of\n// configuration and override a value.\n// If the environment contains these values:\n//\n// UPWARD_JS_HOST=https://local.pwadev\n// UPWARD_JS_PORT=443\n// UPWARD_JS_BIND_LOCAL=\n// MAGENTO_BACKEND_URL=https://local.magento\n//\n// Then the above code passes the following object to \\`createUpwardServer\\`:\n//\n// {\n//   host: 'https://local.pwadev',\n//   port: '443',\n//   backendUrl: 'https://local.magento',\n//   bindLocal: true\n// }\n\n// The \\`sections()\\` method can split an env object into named subsections:\ncreateUpwardServer(configuration.sections(\"upwardJs\", \"magento\"));\n\n// Given the same environment variables as above, this code will pass the\n// following to \\`createUpwardServer\\`:\n//\n// {\n//   upwardJs: {\n//     host: 'https://local.pwadev',\n//     port: '443',\n//     bindLocal: '' // the null string is used as a falsy value\n//   },\n//   magento: {\n//     backendUrl: 'https://local.magento'\n//   }\n// }\n//\n// (The above is not the actual config object format for \\`createUpwardServer\\`,\n// but if it was, that's how you'd make it.)\n\n// Use the convenience properties \\`isProd\\` and \\`isDev\\` instead of testing\n// \\`process.env.NODE_ENV\\` directly:\nif (configuration.isDev) {\n  console.log(\"Development mode\");\n}\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}